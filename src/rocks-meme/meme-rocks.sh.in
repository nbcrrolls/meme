#!/bin/bash

# make links for web CGI access 
if [ -e /var/www/html/meme ] ; then
   rm -rf /var/www/html/meme
fi
ln -s /opt/meme_@MEMEVER@/web /var/www/html/meme_@MEMEVER@
ln -s /opt/meme_@MEMEVER@/web /var/www/html/meme

if [ ! -e /var/www/html/meme_@MEMEPREV@ ] ; then
    ln -s /opt/meme_@MEMEPREV@/web /var/www/html/meme_@MEMEPREV@
fi

# NFS-shared directories for meme output, logs, and user temp files
BASE=/state/partition1/meme/
mkdir -p $BASE

# NFS-shared directories for meme output
mkdir -p $BASE/output-@MEMEVER@
mkdir -p $BASE/output-@MEMEPREV@
chown tomcat:tomcat $BASE/output-*

# NFS-shared directories for temp user files 
mkdir -p $BASE/user-files-@MEMEVER@
mkdir -p $BASE/user-files-@MEMEPREV@
chown tomcat:tomcat  $BASE/user-files-*

# NFS-shared directories for usage logs 
mkdir -p $BASE/LOGS-@MEMEVER@
mkdir -p $BASE/LOGS-@MEMEPREV@
chown tomcat:tomcat  $BASE/LOGS-*
